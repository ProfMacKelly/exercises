<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contract Law Quiz - Deep Blue Edition</title>
    <link rel="icon" href="/exercises/favicon.ico" type="image/x-icon">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@600;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap');

        :root {
            /* Custom Deep Blue Theme */
            --bg: #0B4779; /* Lighter top gradient */
            --bg-deep: #02376B; /* Your requested deep blue */
            --ink: #ffffff; /* White text for dark BG */
            --muted: #cbd5e0;
            --accent: #461901; /* Warm gold/orange for contrast */
            --accent-light: #ffbd7f;
            --accent-dark: #e67e22;
            --teal: #4cd137; 
            --card: #f5deb3; /* Keep cards white for readability */
            --card-text: #0C0A09; /* Text inside the white cards */
            --stroke: #2d3436;
            --shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            --radius-sm: 10px;
            --radius-md: 12px;
            --radius-lg: 14px;
            --radius-xl: 18px;
            --radius-2xl: 22px;
            --font-display: 'Space Grotesk', sans-serif;
            --font-body: 'IBM Plex Sans', sans-serif;
            --error: #ff7675;
        }

        body {
            font-family: var(--font-body);
            /* Rich gradient using your requested #0B4779 */
            background: radial-gradient(circle at top left, var(--bg), var(--bg-deep) 70%);
            color: var(--ink);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .quiz-container {
            width: 100%;
            max-width: 800px;
            padding: 32px 24px;
            box-sizing: border-box;
            background: var(--card);
            color: var(--card-text); /* Ensure questions/options are dark on white */
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow);
        }

        .progress-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .progress-text { color: #718096; font-size: 0.9em; font-weight: 600; }
        .status-bar { display: flex; gap: 16px; font-size: 0.9em; font-weight: 500; }
        .status-correct { color: #2e7d32; }
        .status-wrong { color: #d32f2f; }

        .question-text {
            font-family: var(--font-display);
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 32px;
            line-height: 1.3;
            color: #000000;
        }

        .options-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-item {
            background-color: #f8fafc;
            border: 2px solid #461901;
            padding: 16px;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option-item:hover:not(.selected) {
            background-color: #f1f5f9;
            border-color: #432004;
            transform: translateX(5px);
        }

        .option-item.selected.correct {
            background-color: #f0fff4;
            border-color: #48bb78;
        }

        .option-item.selected.incorrect {
            background-color: #fff5f5;
            border-color: #f56565;
        }

        .option-item.revealed-correct {
            border-color: #48bb78;
            background-color: #f0fff4;
        }

        .feedback-state { font-weight: bold; font-size: 0.9em; display: none; margin-top: 4px; }
        .selected .feedback-state, .revealed-correct .feedback-state { display: block; }
        .correct .feedback-state, .revealed-correct .feedback-state { color: #2f855a; }
        .incorrect .feedback-state { color: #c53030; }

        .rationale { font-size: 0.95em; color: #4a5568; margin-top: 6px; display: none; }
        .selected .rationale, .revealed-correct .rationale { display: block; }

        .hint-content {
            margin-top: 24px;
            padding: 16px;
            background-color: #fffaf0;
            border-left: 4px solid var(--accent);
            border-radius: var(--radius-md);
            display: none;
            color: #0C0A09;
        }
        .hint-content.active { display: block; }

        .navigation {
            margin-top: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            border-radius: var(--radius-md);
            padding: 12px 24px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }

        .btn-prev { background-color: #edf2f7; color: #4a5568; }
        .btn-next { background: var(--bg-deep); color: #fff; }
        .btn-next:hover { opacity: 0.9; transform: translateY(-2px); }

        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="quiz-container">
        <div id="quiz-content"></div>
        <div id="results-content" class="hidden"></div>
        <div id="hint-box" class="hint-content"></div>

        <div class="navigation">
            <button id="hint-toggle" class="btn btn-prev">ðŸ’¡ Hint</button>
            <div class="nav-buttons">
                <button id="prev-btn" class="btn btn-prev">Previous</button>
                <button id="next-btn" class="btn btn-next">Next</button>
            </div>
        </div>
    </div>

    <script>
        const quizData = [
            {
                "question": "Which defense applies when a contract's primary purpose is rendered valueless by an unforeseen event, even if performance is still possible?",
                "hint": "Think about a situation where you can still do the work, but the reason for the work no longer exists.",
                "answerOptions": [
                    { "text": "Frustration of Purpose", "isCorrect": true, "rationale": "This defense occurs when an unforeseen event undermines a party's principal purpose for entering the contract." },
                    { "text": "Commercial Impracticability", "isCorrect": false, "rationale": "This applies when performance becomes excessively difficult or expensive, not necessarily valueless." },
                    { "text": "Mutual Mistake", "isCorrect": false, "rationale": "This involves a mistake about a fact at the time the contract was made, not a later event." }
                ]
            },
            {
                "question": "A minor (under 18) enters into a contract for a non-essential luxury item. Why is this contract likely unenforceable?",
                "hint": "This relates to the legal standing or power of the person signing.",
                "answerOptions": [
                    { "text": "Lack of Consideration", "isCorrect": false, "rationale": "There is usually consideration (money for item); the issue is the person's age." },
                    { "text": "Lack of Capacity", "isCorrect": true, "rationale": "Minors generally lack the legal capacity to enter into binding contracts, making them voidable at the minor's option." },
                    { "text": "Undue Influence", "isCorrect": false, "rationale": "This requires proof of a special relationship and unfair persuasion." }
                ]
            },
            {
                "question": "Under the Statute of Frauds, which of the following contracts MUST be in writing to be enforceable?",
                "hint": "Look for the option involving a significant time commitment or high value.",
                "answerOptions": [
                    { "text": "A service contract for 6 months.", "isCorrect": false, "rationale": "Only contracts that *cannot* be performed within one year fall under this rule." },
                    { "text": "A contract for the sale of goods over $500.", "isCorrect": true, "rationale": "Under the UCC, contracts for the sale of goods for $500 or more must generally be in writing." },
                    { "text": "A contract for a $200 monthly gym membership.", "isCorrect": false, "rationale": "This does not typically require a writing unless it's for a term longer than one year." }
                ]
            }
        ];

        let currentIndex = 0;
        let state = quizData.map(() => ({ selectedIndex: null, hintVisible: false }));

        function getStats() {
            const answered = state.filter(s => s.selectedIndex !== null).length;
            const correct = state.filter((s, i) => s.selectedIndex !== null && quizData[i].answerOptions[s.selectedIndex].isCorrect).length;
            return { answered, correct, total: quizData.length };
        }

        function renderQuestion() {
            const q = quizData[currentIndex];
            const s = state[currentIndex];
            const content = document.getElementById('quiz-content');
            const stats = getStats();

            let optionsHtml = q.answerOptions.map((opt, idx) => {
                const isSelected = s.selectedIndex === idx;
                const statusClass = isSelected ? (opt.isCorrect ? 'correct' : 'incorrect') : '';
                const revealClass = (s.selectedIndex !== null && opt.isCorrect) ? 'revealed-correct' : '';
                return `
                    <li class="option-item ${isSelected ? 'selected' : ''} ${statusClass} ${revealClass}" onclick="selectOption(${idx})">
                        <strong>${String.fromCharCode(65 + idx)}.</strong> ${opt.text}
                        <div class="feedback-state">${opt.isCorrect ? 'âœ“ Correct' : 'âœ• Incorrect'}</div>
                        <div class="rationale">${opt.rationale}</div>
                    </li>`;
            }).join('');

            content.innerHTML = `
                <div class="progress-container">
                    <div class="progress-text">QUESTION ${currentIndex + 1} OF ${quizData.length}</div>
                    <div class="status-bar">
                        <span class="status-correct">âœ“ ${stats.correct}</span>
                    </div>
                </div>
                <div class="question-text">${q.question}</div>
                <ul class="options-list">${optionsHtml}</ul>
            `;

            const hintBox = document.getElementById('hint-box');
            hintBox.innerText = q.hint;
            hintBox.classList.toggle('active', s.hintVisible);
            document.getElementById('prev-btn').disabled = currentIndex === 0;
            document.getElementById('next-btn').innerText = currentIndex === quizData.length - 1 ? 'Finish' : 'Next';
        }

        window.selectOption = function(idx) {
            if (state[currentIndex].selectedIndex === null) {
                state[currentIndex].selectedIndex = idx;
                renderQuestion();
            }
        };

        document.getElementById('hint-toggle').onclick = () => {
            state[currentIndex].hintVisible = !state[currentIndex].hintVisible;
            renderQuestion();
        };

        document.getElementById('prev-btn').onclick = () => { if (currentIndex > 0) { currentIndex--; renderQuestion(); }};
        document.getElementById('next-btn').onclick = () => {
            if (currentIndex < quizData.length - 1) {
                currentIndex++;
                renderQuestion();
            } else {
                renderResults();
            }
        };

        function renderResults() {
            const stats = getStats();
            document.getElementById('quiz-content').innerHTML = `
                <div style="text-align: center; padding: 40px 0;">
                    <h1 class="question-text">Quiz Complete</h1>
                    <p style="font-size: 1.2em; color: #4a5568;">You mastered ${stats.correct} out of ${stats.total} questions!</p>
                    <button onclick="location.reload()" class="btn btn-next">Retake Quiz</button>
                </div>
            `;
            document.getElementById('hint-box').classList.add('hidden');
            document.querySelector('.navigation').classList.add('hidden');
        }

        renderQuestion();
    </script>
</body>
